<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>課表試排</title>
    <style>
        .class-info {
            width: 90%;
            display: flex;
            margin-bottom: 30px;
        }

        .class-info div {
            margin-right: 10px;
        }

        .months {
            margin-bottom: 50px;
        }

        .weeks {
            width: 90%;
            min-width: 1170px;
            display: flex;
            flex-wrap: wrap;
            align-items: flex-start;
            justify-content: flex-start;
        }

        .days,
        .week-titles {
            box-sizing: border-box;
            min-width: 12.28%;
            min-height: 0px;
            /* padding: 15px; */
            text-align: center;
            margin: 1%;
            background-color: #ccc;
        }

        .week-titles {
            background-color: #afa;
        }

        .holiday {
            background-color: rgb(235, 171, 235);
        }

        div[draggable="true"] {
            /*
   To prevent user selecting inside the drag source
  */
            user-select: none;
            -moz-user-select: none;
            -webkit-user-select: none;
            -ms-user-select: none;
        }

        .MFEE11 {
            background-color: rgb(247, 249, 153);
        }

        .MMMH60 {
            background-color: rgb(165, 231, 237);
        }
    </style>
</head>

<body>
    <div class="class-info">
        <div class="mfee11">
            <label for="">前端班開課日期：</label>
            <input type="date" id="getMFEEDay">
        </div>

        <div class="mmmh60">
            <label for="">uiux班開課日期：</label>
            <input type="date" id="getMMMH60Day">
        </div>
    </div>


    <div id="root"></div>
    <!-- <div class="month">
        <div class="month-title">11月</div>
        <div class="weeks">
            <div class="days">1</div>
            <div class="days">2</div>
        </div>

    </div> -->

    <script src="https://unpkg.com/dayjs@1.8.21/dayjs.min.js"></script>
    <!-- <script src="https://cdn.jsdelivr.net/npm/dayjs@1.9.1/plugin/isSameOrAfter.min.js"></script> -->
    <script>

        // dayjs('2019-01-25').daysInMonth() 月份天數
        // dayjs(`2019-12-${i}`).day() 星期幾
        const root = document.querySelector('#root');


        const holidays2021 = ['2021-10-1', '2021-10-2', '2021-10-9', '2020-10-10', '2021-10-11', '2021-1-1', '2021-1-2', '2021-1-3', '2021-2-10', '2021-2-11', '2021-2-12', '2021-2-13', '2021-2-14', '2021-2-15', '2021-2-16', '2021-2-27', '2021-2-28', , '2021-3-01', '2021-4-2', '2021-4-3', '2021-4-4', '2021-4-5', '2021-6-12', '2021-6-13', '2021-6-14', '2021-9-19', '2021-9-20', '2021-9-21', '2021-10-9', '2021-10-10', '2021-10-11', '2021-12-31', '2022-1-1', '2022-1-2', '2022-1-29', '2022-1-30', '2022-1-31', '2022-2-1', '2022-2-2', '2022-2-3', '2022-2-4', '2022-2-5', '2022-2-6', '2022-2-26', , '2022-2-27', '2022-2-28', '2022-4-2', '2022-4-3', '2022-4-4', '2022-4-5', '2022-6-3', '2022-6-4', '2022-6-5', '2022-9-9', '2022-9-10', '2022-9-11', '2022-10-8', '2022-10-9', '2022-10-10'];

        const checkIfHoliday = (date) => {
            let isHoliday = false;
            holidays2021.forEach((holiday) => {
                if (dayjs(date).isSame(holiday) || dayjs(date).day() === 0 || dayjs(date).day() === 6) isHoliday = true;
            })

            return isHoliday;
        }

        const week1 = [['<div class="class-title" draggable="true">導師時間</div>', '<div class="class-title" draggable="true">開訓典禮</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">網頁設計入門</div>', '<div class="class-title" draggable="true">網頁設計入門</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">網頁設計入門</div>', '<div class="class-title" draggable="true">網頁設計入門</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">網站視覺設計</div>', '<div class="class-title" draggable="true">網站視覺設計</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">網頁設計入門</div>', '<div class="class-title" draggable="true">網頁設計入門</div>', '<div class="class-title" draggable="true">N/A</div>']];

        const week2 = [['<div class="class-title" draggable="true">網站視覺設計</div>', '<div class="class-title" draggable="true">網站視覺設計</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">網站視覺設計</div>', '<div class="class-title" draggable="true">網站視覺設計</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">網站視覺設計</div>', '<div class="class-title" draggable="true">網站視覺設計</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">網站視覺設計</div>', '<div class="class-title" draggable="true">網站規劃</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">網站視覺設計</div>', '<div class="class-title" draggable="true">網站視覺設計</div>', '<div class="class-title" draggable="true">N/A</div>']];
        const week3 = [['<div class="class-title" draggable="true">網站視覺設計</div>', '<div class="class-title" draggable="true">LAB1</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">CSS</div>', '<div class="class-title" draggable="true">CSS</div>', '<div class="class-title" draggable="true">LAB2</div>'], ['<div class="class-title" draggable="true">CSS</div>', '<div class="class-title" draggable="true">CSS</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">CSS</div>', '<div class="class-title" draggable="true">CSS</div>', '<div class="class-title" draggable="true">LAB3</div>'], ['<div class="class-title" draggable="true">Bootstrap</div>', '<div class="class-title" draggable="true">Bootstrap</div>', '<div class="class-title" draggable="true">N/A</div>']];
        const week4 = [['<div class="class-title" draggable="true">Bootstrap</div>', '<div class="class-title" draggable="true">Bootstrap</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">Bootstrap</div>', '<div class="class-title" draggable="true">Bootstrap</div>', '<div class="class-title" draggable="true">LAB4</div>'], ['<div class="class-title" draggable="true">UI設計實作</div>', '<div class="class-title" draggable="true">UI設計實作</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">UI設計實作</div>', '<div class="class-title" draggable="true">UI設計實作</div>', '<div class="class-title" draggable="true">LAB5</div>'], ['<div class="class-title" draggable="true">專題觀摩</div>', '<div class="class-title" draggable="true">網站規劃</div>', '<div class="class-title" draggable="true">N/A</div>']];
        const week5 = [['<div class="class-title" draggable="true">UI設計實作</div>', '<div class="class-title" draggable="true">UI設計實作</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">JS</div>', '<div class="class-title" draggable="true">JS</div>', '<div class="class-title" draggable="true">LAB6</div>'], ['<div class="class-title" draggable="true">JS</div>', '<div class="class-title" draggable="true">JS</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">JS</div>', '<div class="class-title" draggable="true">網站規劃</div>', '<div class="class-title" draggable="true">LAB7</div>'], ['<div class="class-title" draggable="true">JS</div>', '<div class="class-title" draggable="true">JS Advanced</div>', '<div class="class-title" draggable="true">N/A</div>']];
        const week6 = [['<div class="class-title" draggable="true">JS Advanced</div>', '<div class="class-title" draggable="true">JS Advanced</div>', '<div class="class-title" draggable="true">N/A</div>']];

        const week7 = [['<div class="class-title" draggable="true">JS Advanced</div>', '<div class="class-title" draggable="true">JS Advanced</div>', '<div class="class-title" draggable="true">LAB8</div>'], ['<div class="class-title" draggable="true">JS Advanced</div>', '<div class="class-title" draggable="true">專題指導</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">MySQL</div>', '<div class="class-title" draggable="true">專題指導</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">MySQL</div>', '<div class="class-title" draggable="true">MySQL</div>', '<div class="class-title" draggable="true">N/A</div>']];
        const week8 = [['<div class="class-title" draggable="true">MySQL</div>', '<div class="class-title" draggable="true">N/A</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">MySQL</div>', '<div class="class-title" draggable="true">MySQL</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">PHP</div>', '<div class="class-title" draggable="true">期中專題製作</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">PHP</div>', '<div class="class-title" draggable="true">PHP</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">PHP</div>', '<div class="class-title" draggable="true">期中專題製作</div>', '<div class="class-title" draggable="true">N/A</div>']];
        const week9 = [['<div class="class-title" draggable="true">PHP</div>', '<div class="class-title" draggable="true">PHP</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">PHP</div>', '<div class="class-title" draggable="true">PHP</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">PHP</div>', '<div class="class-title" draggable="true">LAB9</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">PHP</div>', '<div class="class-title" draggable="true">PHP</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">LAB10</div>', '<div class="class-title" draggable="true">PHP</div>', '<div class="class-title" draggable="true">N/A</div>']];
        const week10 = [['<div class="class-title" draggable="true">期中專題製作</div>', '<div class="class-title" draggable="true">期中專題製作</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">期中專題製作</div>', '<div class="class-title" draggable="true">期中專題製作</div>', '<div class="class-title" draggable="true">LAB11</div>'], ['<div class="class-title" draggable="true">期中專題製作</div>', '<div class="class-title" draggable="true">期中專題製作</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">期中專題製作</div>', '<div class="class-title" draggable="true">期中專題製作</div>', '<div class="class-title" draggable="true">LAB12</div>'], ['<div class="class-title" draggable="true">期中專題製作</div>', '<div class="class-title" draggable="true">期中專題製作</div>', '<div class="class-title" draggable="true">N/A</div>']];
        const week11 = [['<div class="class-title" draggable="true">jQuery</div>', '<div class="class-title" draggable="true">jQuery</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">jQuery</div>', '<div class="class-title" draggable="true">jQuery</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">jQuery</div>', '<div class="class-title" draggable="true">jQuery</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">Plugin</div>', '<div class="class-title" draggable="true">Plugin</div>', '<div class="class-title" draggable="true">LAB13</div>']];

        const week12 = [['<div class="class-title" draggable="true">Plugin</div>', '<div class="class-title" draggable="true">Plugin</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">Plugin</div>', '<div class="class-title" draggable="true">Plugin</div>', '<div class="class-title" draggable="true">LAB14</div>'], ['<div class="class-title" draggable="true">Node.js</div>', '<div class="class-title" draggable="true">網站規劃</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">Node.js</div>', '<div class="class-title" draggable="true">Node.js</div>', '<div class="class-title" draggable="true">LAB15</div>'], ['<div class="class-title" draggable="true">Node.js</div>', '<div class="class-title" draggable="true">Node.js</div>', '<div class="class-title" draggable="true">N/A</div>']];
        const week13 = [['<div class="class-title" draggable="true">Node.js</div>', '<div class="class-title" draggable="true">職場講座</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">Node.js前後端</div>', '<div class="class-title" draggable="true">Node.js前後端</div>', '<div class="class-title" draggable="true">LAB16</div>'], ['<div class="class-title" draggable="true">Node.js前後端</div>', '<div class="class-title" draggable="true">Node.js前後端</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">Node.js前後端</div>', '<div class="class-title" draggable="true">Node.js前後端</div>', '<div class="class-title" draggable="true">LAB17</div>'], ['<div class="class-title" draggable="true">N/A</div>', '<div class="class-title" draggable="true">網站規劃</div>', '<div class="class-title" draggable="true">N/A</div>']];
        const week14 = [['<div class="class-title" draggable="true">HTML5 API</div>', '<div class="class-title" draggable="true">HTML5 API</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">HTML5 API</div>', '<div class="class-title" draggable="true">HTML5 API</div>', '<div class="class-title" draggable="true">LAB18</div>'], ['<div class="class-title" draggable="true">HTML5 API</div>', '<div class="class-title" draggable="true">HTML5 API</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">React.js</div>', '<div class="class-title" draggable="true">React.js</div>', '<div class="class-title" draggable="true">LAB19</div>'], ['<div class="class-title" draggable="true">React.js</div>', '<div class="class-title" draggable="true">網站規劃</div>', '<div class="class-title" draggable="true">N/A</div>']];
        const week15 = [['<div class="class-title" draggable="true">React.js</div>', '<div class="class-title" draggable="true">React.js</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">React.js</div>', '<div class="class-title" draggable="true">React.js</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">React.js</div>', '<div class="class-title" draggable="true">模擬面試</div>', '<div class="class-title" draggable="true">LAB20</div>'], ['<div class="class-title" draggable="true">React.js</div>', '<div class="class-title" draggable="true">React.js</div>', '<div class="class-title" draggable="true">N/A</div>']];

        const week16 = [['<div class="class-title" draggable="true">React.js</div>', '<div class="class-title" draggable="true">React.js</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">專題指導</div>', '<div class="class-title" draggable="true">專題指導</div>', '<div class="class-title" draggable="true">LAB21</div>'], ['<div class="class-title" draggable="true">期末專題製作</div>', '<div class="class-title" draggable="true">專題指導</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">LAB22</div>', '<div class="class-title" draggable="true">專題指導</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">期末專題製作</div>', '<div class="class-title" draggable="true">專題指導</div>', '<div class="class-title" draggable="true">N/A</div>']];
        const week17 = [['<div class="class-title" draggable="true">期末專題製作</div>', '<div class="class-title" draggable="true">專題指導</div>', '<div class="class-title" draggable="true">LAB23</div>'], ['<div class="class-title" draggable="true">期末專題製作</div>', '<div class="class-title" draggable="true">N/A</div>', '<div class="class-title" draggable="true">N/A</div>']];
        const week18 = [['<div class="class-title" draggable="true">N/A</div>', '<div class="class-title" draggable="true">專題指導</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">期末專題製作</div>', '<div class="class-title" draggable="true">專題指導</div>', '<div class="class-title" draggable="true">LAB24</div>'], ['<div class="class-title" draggable="true">期末專題製作</div>', '<div class="class-title" draggable="true">專題指導</div>', '<div class="class-title" draggable="true">N/A</div>']];
        const week19 = [['<div class="class-title" draggable="true">期末專題製作</div>', '<div class="class-title" draggable="true">專題指導</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">期末專題製作</div>', '<div class="class-title" draggable="true">期末專題製作</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">期末專題製作</div>', '<div class="class-title" draggable="true">專題指導</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">期末專題製作</div>', '<div class="class-title" draggable="true">期末專題製作</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">期末專題製作</div>', '<div class="class-title" draggable="true">專題指導</div>', '<div class="class-title" draggable="true">N/A</div>']];

        const week20 = [['<div class="class-title" draggable="true">期末專題製作</div>', '<div class="class-title" draggable="true">專題指導</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">期末專題製作</div>', '<div class="class-title" draggable="true">專題指導</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">專題預演</div>', '<div class="class-title" draggable="true">期末專題製作</div>', '<div class="class-title" draggable="true">N/A</div>'], ['<div class="class-title" draggable="true">專題發表</div>', '<div class="class-title" draggable="true">就業媒合活動</div>', '<div class="class-title" draggable="true">N/A</div>']];


        const allWeeks = [...week1, ...week2, ...week3, ...week4, ...week5, ...week6, ...week7, ...week8, ...week9, ...week10, ...week11, ...week12, ...week13, ...week14, ...week15, ...week16, ...week17, ...week18, ...week19, ...week20];


        const weekUIUX1 = [['<div class=""class-title"">開訓典禮</div>', '<div class=""class-title"">導師時間</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">多媒體概論</div>', '<div class=""class-title"">Illustrator(1)</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">Illustrator(2)</div>', '<div class=""class-title"">Illustrator(3)</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">Illustrator(4)</div>', '<div class=""class-title"">Illustrator(5)</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">Illustrator(6)</div>', '<div class=""class-title"">Illustrator(7)</div>', '<div class=""class-title"">N/A</div>']];
        const weekUIUX2 = [['<div class=""class-title"">Illustrator(8)</div>', '<div class=""class-title"">Illustrator(9)</div>', '<div class=""class-title"">N/A</div>']];

        const weekUIUX3 = [['<div class=""class-title"">Illustrator(10)</div>', '<div class=""class-title"">Illustrator(11)</div>', '<div class=""class-title"">Lab(1)</div>'], ['<div class=""class-title"">Illustrator(12)</div>', '<div class=""class-title"">Photoshop(1)</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">Photoshop(2)</div>', '<div class=""class-title"">網站規劃(1)</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">Photoshop(3)</div>', '<div class=""class-title"">Photoshop(4)</div>', '<div class=""class-title"">N/A</div>']];
        const weekUIUX4 = [['<div class=""class-title"">Photoshop(5)</div>', '<div class=""class-title"">Photoshop(6)</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">Photoshop(7)</div>', '<div class=""class-title"">Photoshop(8)</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">網頁設計入門(1)</div>', '<div class=""class-title"">網頁設計入門(2)</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">Photoshop(9)</div>', '<div class=""class-title"">Photoshop(10)</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">網頁設計入門(3)</div>', '<div class=""class-title"">UX(1)</div>', '<div class=""class-title"">N/A</div>']];
        const weekUIUX5 = [['<div class=""class-title"">Photoshop(11)</div>', '<div class=""class-title"">網頁設計入門(4)</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">Photoshop(12)</div>', '<div class=""class-title"">Lab(2)</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">網頁設計入門(5)</div>', '<div class=""class-title"">N/A</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">網頁設計入門(6)</div>', '<div class=""class-title"">Lab(3)</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">網站規劃(2)</div>', '<div class=""class-title"">UX(2)</div>', '<div class=""class-title"">N/A</div>']];
        const weekUIUX6 = [['<div class=""class-title"">CSS3(1)</div>', '<div class=""class-title"">CSS3(2)</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">CSS3(3)</div>', '<div class=""class-title"">CSS3(4)</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">CSS3(5)</div>', '<div class=""class-title"">UX(3)</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">CSS3(6)</div>', '<div class=""class-title"">Bootstrap(1)</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">Bootstrap(2)</div>', '<div class=""class-title"">Bootstrap(3)</div>', '<div class=""class-title"">N/A</div>']];
        const weekUIUX7 = [['<div class=""class-title"">Bootstrap(4)</div>', '<div class=""class-title"">Lab(10)</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">Bootstrap(5)</div>', '<div class=""class-title"">Bootstrap(6)</div>', '<div class=""class-title"">Lab(4)</div>'], ['<div class=""class-title"">Adobe XD(1)</div>', '<div class=""class-title"">Adobe XD(2)</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">中秋節</div>', '<div class=""class-title"">N/A</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">N/A</div>', '<div class=""class-title"">N/A</div>', '<div class=""class-title"">N/A</div>']];

        const weekUIUX8 = [['<div class=""class-title"">Adobe XD(3)</div>', '<div class=""class-title"">Adobe XD(4)</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">Adobe XD(5)</div>', '<div class=""class-title"">Adobe XD(6)</div>', '<div class=""class-title"">Lab(5)</div>'], ['<div class=""class-title"">網站規劃(3)</div>', '<div class=""class-title"">UX(5)</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">jQuery UI(1)</div>', '<div class=""class-title"">jQuery UI(2)</div>', '<div class=""class-title"">Lab(6)</div>']];
        const weekUIUX9 = [['<div class=""class-title"">jQuery UI(3)</div>', '<div class=""class-title"">jQuery UI(4)</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">jQuery UI(5)</div>', '<div class=""class-title"">jQuery UI(6)</div>', '<div class=""class-title"">Lab(7)</div>'], ['<div class=""class-title"">jQuery Plugin(1)</div>', '<div class=""class-title"">jQuery Plugin(2)</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">jQuery Plugin(3)</div>', '<div class=""class-title"">jQuery Plugin(4)</div>', '<div class=""class-title"">期中專題(1)</div>'], ['<div class=""class-title"">jQuery Plugin(5)</div>', '<div class=""class-title"">jQuery Plugin(6)</div>', '<div class=""class-title"">N/A</div>']];
        const weekUIUX10 = [['<div class=""class-title"">UX(6)</div>', '<div class=""class-title"">期中專題(2)</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">期中專題(3)</div>', '<div class=""class-title"">期中專題(4)</div>', '<div class=""class-title"">期中專題(5)</div>'], ['<div class=""class-title"">期中專題(6)</div>', '<div class=""class-title"">期中專題(7)</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">期中專題(8)</div>', '<div class=""class-title"">期中專題(9)</div>', '<div class=""class-title"">期中專題(10)</div>'], ['<div class=""class-title"">期中專題(11)</div>', '<div class=""class-title"">期中專題(12)</div>', '<div class=""class-title"">N/A</div>']];
        const weekUIUX11 = [['<div class=""class-title"">Lab(8)</div>', '<div class=""class-title"">專題指導-劉(1)</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">JS(1)</div>', '<div class=""class-title"">JS(2)</div>', '<div class=""class-title"">職場講座</div>'], ['<div class=""class-title"">JS(3)</div>', '<div class=""class-title"">JS(4)</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">JS(5)</div>', '<div class=""class-title"">JS(6)</div>', '<div class=""class-title"">Lab(9)</div>'], ['<div class=""class-title"">JS advance(1)</div>', '<div class=""class-title"">UX(4)</div>', '<div class=""class-title"">N/A</div>']];

        const weekUIUX12 = [['<div class=""class-title"">JS advance(3)</div>', '<div class=""class-title"">JS advance(4)</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">JS advance(5)</div>', '<div class=""class-title"">網站規劃(4)</div>', '<div class=""class-title"">Lab(11)</div>'], ['<div class=""class-title"">JS advance(6)</div>', '<div class=""class-title"">My SQL(1)</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">My SQL(2)</div>', '<div class=""class-title"">My SQL(3)</div>', '<div class=""class-title"">Lab(12)</div>'], ['<div class=""class-title"">My SQL(4)</div>', '<div class=""class-title"">JS advance(2)</div>', '<div class=""class-title"">N/A</div>']];
        const weekUIUX13 = [['<div class=""class-title"">My SQL(5)</div>', '<div class=""class-title"">My SQL(6)</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">Php (1)</div>', '<div class=""class-title"">Php (2)</div>', '<div class=""class-title"">Lab(13)</div>'], ['<div class=""class-title"">Php (3)</div>', '<div class=""class-title"">網站規劃(5)</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">Php (4)</div>', '<div class=""class-title"">Php (5)</div>', '<div class=""class-title"">Lab(14)</div>'], ['<div class=""class-title"">Php (6)</div>', '<div class=""class-title"">Php (7)</div>', '<div class=""class-title"">N/A</div>']];
        const weekUIUX14 = [['<div class=""class-title"">Php (8)</div>', '<div class=""class-title"">Php (9)</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">Php (10)</div>', '<div class=""class-title"">Php (11)</div>', '<div class=""class-title"">Lab(15)</div>'], ['<div class=""class-title"">Php (12)</div>', '<div class=""class-title"">模擬面試</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">期末專題作(1)</div>', '<div class=""class-title"">網站規劃(6)</div>', '<div class=""class-title"">Lab(16)</div>'], ['<div class=""class-title"">專題觀摩</div > ', ' < div class= ""class- title"" > 專題指導 - 林(1)</ > ', ' < div class= ""class- title"" > N / A</ > ']];
        const weekUIUX15 = [['<div class=""class-title"">期末專題作(2)</div>', '<div class=""class-title"">專題指導-劉(2)</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">期末專題(3)</div>', '<div class=""class-title"">專題指導-劉(3)</div>', '<div class=""class-title"">Lab(17)</div>'], ['<div class=""class-title"">期末專題(4)</div>', '<div class=""class-title"">期末專題(5)</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">期末專題(6)</div>', '<div class=""class-title"">專題指導-劉(4)</div>', '<div class=""class-title"">Lab(18)</div>'], ['<div class=""class-title"">期末專題(7)</div>', '<div class=""class-title"">專題指導-林(2)</div>', '<div class=""class-title"">N/A</div>']];
        const weekUIUX16 = [['<div class=""class-title"">期末專題作(8)</div>', '<div class=""class-title"">專題指導-劉(5)</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">N/A</div>', '<div class=""class-title"">N/A</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">N/A</div>', '<div class=""class-title"">N/A</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">N/A</div>', '<div class=""class-title"">N/A</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">N/A</div>', '<div class=""class-title"">N/A</div>', '<div class=""class-title"">N/A</div>']];

        const weekUIUX17 = [['<div class=""class-title"">N/A</div>', '<div class=""class-title"">N/A</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">期末專題(9)</div>', '<div class=""class-title"">專題指導-林(3)</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">期末專題(10)</div>', '<div class=""class-title"">專題指導-林(4)</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">期末專題(11)</div>', '<div class=""class-title"">專題指導-林(5)</div>', '<div class=""class-title"">Lab(19)</div>'], ['<div class=""class-title"">期末專題(12)</div>', '<div class=""class-title"">專題指導-劉(6)</div>', '<div class=""class-title"">N/A</div>']];
        const weekUIUX18 = [['<div class=""class-title"">期末專題(13)</div>', '<div class=""class-title"">專題指導-林(6)</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">期末專題(14)</div>', '<div class=""class-title"">專題指導-劉(7)</div>', '<div class=""class-title"">Lab(20)</div>'], ['<div class=""class-title"">期末專題(15)</div>', '<div class=""class-title"">專題指導-林(7)</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">期末專題(16)</div>', '<div class=""class-title"">專題指導-劉(8)</div>', '<div class=""class-title"">Lab(21)</div>'], ['<div class=""class-title"">期末專題(17)</div>', '<div class=""class-title"">專題指導-林(8)</div>', '<div class=""class-title"">N/A</div>']];
        const weekUIUX19 = [['<div class=""class-title"">期末專題(18)</div>', '<div class=""class-title"">專題指導-劉(9)</div>', '<div class=""class-title"">N/A</div>'], ['<div class=""class-title"">N/A</div>', '<div class=""class-title"">LAB-(22)預演</div > ', ' < div class= ""class- title"" > Lab(23)</ > '], [' < div class= ""class- title"" > N / A</ > ', ' < div class= ""class- title"" > 專題指導 - 林(9)</ > ', ' < div class= ""class- title"" > N / A</ > '], [' < div class= ""class- title"" > N / A</ > ', ' < div class= ""class- title"" > 專題預演</ > ', ' < div class= ""class- title"" > Lab(24)</ > '], [' < div class= ""class- title"" > 專題發表 / 結訓典禮</ > ', ' < div class= ""class- title"" > 就業媒合</ > ', ' < div class= ""class- title"" > N / A</ > ']];


        const allWeeksUIUX = [...weekUIUX1, ...weekUIUX2, ...weekUIUX3, ...weekUIUX4, ...weekUIUX5, ...weekUIUX6, ...weekUIUX7, ...weekUIUX8, ...weekUIUX9, ...weekUIUX10, ...weekUIUX11, ...weekUIUX12, ...weekUIUX13, ...weekUIUX14, ...weekUIUX15, ...weekUIUX16, ...weekUIUX17, ...weekUIUX18, ...weekUIUX19]

        const getDay = document.querySelector("#getMFEEDay")
        getDay.value = '2021-02-24';

        const getMMMH60Day = document.querySelector("#getMMMH60Day")
        getMMMH60Day.value = "2020-12-21";

        getDay.addEventListener('change', () => {
            render();
            console.log('getDay.value', getDay.value);
        })

        let year = null;
        let month = null;
        let weekIndex = 0;
        let dayIndex = 0;
        let dayIndexMMMH60 = 0;
        let newMonthDiv = null;
        let newWeekDiv = null;

        const render = () => {
            root.innerHTML = '';
            dayIndex = 0;
            dayIndexMMMH60 = 0;
            // console.log('render');
            renderYearAndMonth(2020, 12, 2022, 12);

        }

        const renderYearAndMonth = (startYear, startMonth, endYear, endMonth) => {
            // console.log('startYear=', startYear);
            for (i = startYear; i <= endYear; i++) {
                // console.log('renderYearAndMonth for i=', i);
                // console.log((startYear === endYear) ? startMonth : (i === startYear) ? startMonth : 1);
                // console.log((i === endYear) ? endMonth : 12);
                renderMonths(i, (startYear === endYear) ? startMonth : (i === startYear) ? startMonth : 1, (i === endYear) ? endMonth : 12);
            }
        }

        const renderMonths = (yearNum, startM, endM) => {
            // console.log('renderMonths yearNum=', yearNum, ' startM=', startM, ' endM=', endM);
            for (let i = startM; i <= endM; i++) {
                month = i;
                year = yearNum;
                weekIndex = 0;
                // console.log('year:', year);
                // console.log('month:', month);

                newMonthDiv = document.createElement('div');
                newMonthDiv.id = `${year}-${month}`;
                newMonthDiv.classList.add(`months`, `month-${month}`);

                let newMonthTitleArea = document.createElement('div');
                newMonthTitleArea.innerHTML = `${year}年 ${month}月`;
                newMonthDiv.append(newMonthTitleArea);

                let newWeekTitleArea = document.createElement('div');
                newWeekTitleArea.classList.add('weeks');
                for (let i = 0; i < 7; i++) {
                    let translateTitle = ['一', '二', '三', '四', '五', '六', '日']
                    let newWeekTitles = document.createElement('div');
                    newWeekTitles.classList.add('week-titles')
                    newWeekTitles.innerHTML = translateTitle[i];
                    newWeekTitleArea.append(newWeekTitles);
                }

                newMonthDiv.append(newWeekTitleArea);
                root.append(newMonthDiv);

                for (let i = 1; i <= dayjs(`${year}-${month}`).daysInMonth(); i++) {

                    if (i === 1 || dayjs(`${year}-${month}-${i}`).day() === 1) {
                        newWeekDiv = document.createElement('div');
                        newWeekDiv.classList.add(`weeks`, `week-${weekIndex}`);
                        if (i === 1) newWeekDiv.style.justifyContent = 'flex-end';
                        newMonthDiv.append(newWeekDiv);
                    }

                    let newDayDiv = document.createElement('div')

                    let newDayTitle = document.createElement('div')
                    newDayTitle.innerHTML = i;
                    newDayTitle.setAttribute("ondrop", "Drop(event)");
                    newDayDiv.setAttribute("ondragover", "AllowDrop(event)");
                    newDayDiv.append(newDayTitle);
                    newDayDiv.className = 'days';

                    if (checkIfHoliday(`${year}-${month}-${i}`)) {
                        newDayDiv.classList.add('holiday');
                    }

                    // console.log(getDay.value);
                    // console.log(`${year}-${(month.toString().length === 2) ? month : '0' + month}-${(i.toString().length === 2) ? i : '0' + i}`);
                    if (`${year}-${(month.toString().length === 2) ? month : '0' + month}-${(i.toString().length === 2) ? i : '0' + i}` === getDay.value) {
                        console.log('hi');
                    }

                    checkIsClassDay(`${year}-${(month.toString().length === 2) ? month : '0' + month}-${(i.toString().length === 2) ? i : '0' + i}`, newDayDiv);



                    newWeekDiv.append(newDayDiv);

                    if (dayjs(`${year}-${month}-${i}`).day() === 1) {
                        weekIndex += 1;
                    }
                }
            }
        }

        const checkIsClassDay = (date, newDayDiv) => {
            if (((date === getDay.value) || (dayIndex > 0 && dayIndex <= allWeeks.length)) && allWeeks[dayIndex] && dayjs(date).day() !== 6 && dayjs(date).day() !== 0 && !checkIfHoliday(date)) {
                let classDayDiv = document.createElement('div');
                for (let k = 0; k < 3; k++) {
                    // console.log('hi', k, ',', week1[i - 1][k]);
                    // console.log('hi1', allWeeks[dayIndex][k].split('div class'));
                    // console.log('hi2', allWeeks[dayIndex][k].split('div class').join(`div id="classday${dayIndex}${k}" class`));
                    classDayDiv.innerHTML += allWeeks[dayIndex][k].split('div class="class-title"').join(`div id="dayMFEE11${dayIndex}${k}" ondragstart="Drag(event)" ondrop="Drop(event)" class="class-title MFEE11"`);
                }
                newDayDiv.append(classDayDiv);
                dayIndex++;
            }

            if (((date === getMMMH60Day.value) || (dayIndexMMMH60 > 0 && dayIndexMMMH60 <= allWeeksUIUX.length)) && allWeeksUIUX[dayIndexMMMH60] && dayjs(date).day() !== 6 && dayjs(date).day() !== 0 && !checkIfHoliday(date)) {
                let classDayDiv = document.createElement('div');

                for (let k = 0; k < 3; k++) {
                    // console.log('hi', k, ',', week1[i - 1][k]);
                    // console.log('hi1', allWeeks[dayIndexMMMH60][k].split('div class'));
                    // console.log('hi2', allWeeks[dayIndexMMMH60][k].split('div class').join(`div id="classday${dayIndexMMMH60}${k}" class`));
                    classDayDiv.innerHTML += allWeeks[dayIndexMMMH60][k].split('div class="class-title"').join(`div id="dayMMMH60${dayIndexMMMH60}${k}" ondragstart="Drag(event)" ondrop="Drop(event)" class="class-title MMMH60"`);
                }
                newDayDiv.append(classDayDiv);
                dayIndexMMMH60++;
            }

        }

        render();

        function insertAfter(newNode, existingNode) {
            existingNode.parentNode.insertBefore(newNode, existingNode.nextSibling);
        }

        document.addEventListener('dragstart', (e) => {
            console.log(e.target);
        })

        document.addEventListener('drop', (e) => {
            console.log('drop', e.target);
        })

        document.addEventListener('dragend', (e) => {
            console.log('dropend', e.target);
        })

        function AllowDrop(event) {
            event.preventDefault();
        }

        function Drag(event) {
            event.dataTransfer.setData("text", event.currentTarget.id);
            event.currentTarget.style.color = 'red';
        }
        function Drop(event) {
            event.preventDefault();
            var data = event.dataTransfer.getData("text");
            insertAfter(document.getElementById(data), event.currentTarget);
            document.getElementById(data).style.color = 'black';
        }



    </script>
</body>

</html>